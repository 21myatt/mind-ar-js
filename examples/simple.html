<html>
  <head>
    <script src="../dist/mindar.js"></script>
    <script>
      const loadImage = async (src) => {
        const img = new Image();
        return new Promise((resolve, reject) => {
          let img = new Image()
          img.onload = () => resolve(img);
          img.onerror = reject;
          img.src = src; 
        })
      }

      const process = async () => {
        const inputWidth = 640;
        const inputHeight = 480;

        const controller = new MINDAR.Controller(inputWidth, inputHeight, (data) => {
          console.log('controller on update', data);
        });
        const proj = controller.getProjectionMatrix();
        console.log("projection matrix", proj);

        await controller.addImageTargets('../tests/card7cpu.mind');

        const queryImage = await loadImage('../tests/card7_2.png');

        for (let i = 0; i < 2; i++) {
          const result = await controller.process(queryImage);
          for (let i = 0; i < result.length; i++) {
            console.log("world matrix", JSON.stringify(result[i]));
          }
        }
      }
      process();
    </script>
  </head>
  <body>
  </body>
</html>
