<html>
  <head>
    <script src="../dist/mindar.js"></script>
    <script>
      const loadImage = async (src) => {
        const img = new Image();
        return new Promise((resolve, reject) => {
          let img = new Image()
          img.onload = () => resolve(img);
          img.onerror = reject;
          img.src = src; 
        })
      }

      const logTime = (title) => {};

      const process = async () => {
        const pw = 640;
        const ph = 480;

        const controller = new MINDAR.Controller(pw, ph);
        const proj = controller.getProjectionMatrix();
        console.log("proj", proj);

        //await controller.addImageTargets('./assets/cards1_7.mind');
        await controller.addImageTargets('../tests/cards7.mind');

        const queryImage = await loadImage('../tests/card7_2.png');
        const queryImage2 = await loadImage('../tests/card7_3.png');

        //for (let i = 0; i < 5; i++) {
        for (let i = 0; i < 1; i++) {
          console.log("process ", i);
          const result = await controller.process( i % 2 === 0? queryImage: queryImage2);
          for (let i = 0; i < result.length; i++) {
            console.log("result", JSON.stringify(result[i]));
          }
        }
      }

      process();
    </script>
  </head>
  <body>
  </body>
</html>
